# Task Dependencies and Work Order
# Generated: 2025-08-04
# Purpose: Track task relationships and identify next work items

# CRITICAL PATH - These are blocking other work
critical_issues:
  # All critical issues have been resolved!

# TEST FAILURES - Need to be fixed for stable codebase
test_failures:
  completed:
    - id: task-75
      title: "Fix failing call_graph.test.ts tests with incorrect call counts"
      completed: "2025-08-04"
      notes: "Resolved as part of cross-file implementation"
      
    - id: task-76
      title: "Fix methods incorrectly appearing in top-level nodes"
      completed: "2025-08-04"
      notes: "Top-level detection now works correctly"
      
    - id: task-77
      title: "Investigate and fix remaining test suite failures"
      completed: "2025-08-04"
      notes: "Only JavaScript test updates remain (task-99)"
      
    - id: task-73
      title: "Fix duplicate call tracking causing test failures"
      completed: "2025-08-04"
      notes: "Resolved during cross-file method resolution implementation"
      
    - id: task-97
      title: "Fix missing ref_to_scope edges causing references to not be attached to scopes"
      completed: "2025-08-04"
      notes: "Implemented ref_to_scope edges successfully"
      
    - id: task-98
      title: "Update JavaScript/TypeScript tests after ref_to_scope edge fix"
      completed: "2025-08-04"
      notes: "TypeScript tests all pass, JavaScript partially updated"
  
  todo:
    - id: task-99
      title: "Complete remaining JavaScript test updates for ref_to_scope changes"
      priority: "Low"
      notes: "6 JavaScript tests need mechanical updates"

# CROSS-FILE RESOLUTION - Core functionality
cross_file_resolution:
  completed:
    - id: task-86
      title: "Implement Rust cross-file method resolution"
      completed: "2025-08-03"
      
    - id: task-65
      title: "Implement file-level variable type tracking"
      completed: "2025-08-03"
      
    - id: task-66
      title: "Connect import resolution with constructor type tracking"
      completed: "2025-08-03"
      
    - id: task-70
      title: "Add language-specific parameter type tracking for Python self"
      completed: "2025-08-03"
      
    - id: task-64
      title: "Add cross-file method resolution for imported classes"
      completed: "2025-08-03"
      
    - id: task-87
      title: "Fix cross-file call tracking functions called from other files show 0 incoming calls"
      completed: "2025-08-04"
      
    - id: task-89
      title: "Fix function over-counting in file summaries"
      completed: "2025-08-04"
      
    - id: task-91
      title: "Fix exported function tracking in top-level detection"
      completed: "2025-08-04"
      
    - id: task-29
      title: "Add circular import detection to prevent infinite loops"
      completed: "2025-08-04"
      notes: "Actually implemented Rust crate:: path resolution"

  completed:
    - id: task-100
      title: "Fix hoisted variable reference resolution"
      completed: "2025-08-04"
      notes: "Implemented var hoisting for nested blocks"
      
  todo:
      
    - id: task-81
      title: "Handle variable reassignments in type registry"
      related: [task-65]
      priority: "Medium"

# VALIDATION & TESTING
validation:
  completed:
    - id: task-93
      title: "Fix TypeScript interface and type counting"
      completed: "2025-08-04"
      notes: "Verified interfaces/types are NOT counted as functions"
      
    - id: task-96
      title: "Fix JavaScript reference detection over-counting"
      completed: "2025-08-04"
      notes: "Investigation revealed missing ref_to_scope edges, created task-97"
      
  in_progress:
    - id: task-62
      title: "Fix agent validation call graph extraction issues"
      status: "In Progress"
      related: [task-74]     # File size limit
      
  todo:
    - id: task-74
      title: "Fix file size limit preventing analysis of large files"
      description: "32KB limit skips critical files like project_call_graph.ts"
      priority: "High"
      status: "Blocked"
      notes: "Waiting for tree-sitter-node response"
      
    - id: task-92
      title: "Add validation test to CI/CD pipeline"
      depends_on: [task-62]
      priority: "Medium"
      
    - id: task-84
      title: "Create generic validation script for external repositories"
      depends_on: [task-62]
      priority: "Low"

# COMPREHENSIVE TESTING
testing:
  completed:
    - id: task-80
      title: "Add comprehensive import/export tests for all languages"
      completed: "2025-08-04"
      notes: "Created 16 tests covering all import/export patterns"
      
    - id: task-28
      title: "Implement proper module path resolution for imports"
      completed: "2025-08-02"
      notes: "Comprehensive implementation with ModuleResolver class"
      
  todo:
    - id: task-82
      title: "Add edge case tests for cross-file resolution"
      related: [task-29]  # Circular import detection
      priority: "Medium"
      
    - id: task-98
      title: "Update JavaScript/TypeScript tests after ref_to_scope edge fix"
      depends_on: [task-97]
      priority: "Medium"

# API IMPROVEMENTS
api_improvements:
  completed:
    - id: task-78
      title: "Fix get_all_functions to properly handle methods vs functions"
      completed: "2025-08-04"
      notes: "Verified get_all_functions already includes methods by default"
      
  todo:
    - id: task-41
      title: "Add error handling and diagnostics for call graph API"
      depends_on: [task-73, task-75, task-76, task-77]  # Fix core issues first
      priority: "Low"

# EXPORT SUPPORT
export_support:
  - id: task-71
    title: "Support CommonJS property assignment exports"
    related: [task-30]
    
  - id: task-72
    title: "Support ES6 exports in .js files and new TypeScript extensions"
    related: [task-30]

# DOCUMENTATION
documentation:
  - id: task-83
    title: "Document supported import/export patterns"
    depends_on: [task-71, task-72]
    priority: "Low"
    notes: "task-80 already completed"

# SUGGESTED WORK ORDER
work_order:
  immediate:
    # All immediate tasks completed!
    
  next:
    - task-81  # Variable reassignments
    - task-23  # Edge case tests
    - task-92  # Add validation to CI/CD
    
  later:
    - task-99  # Complete JavaScript test updates (low priority)
    - task-83  # Document import/export patterns
    - task-84  # Generic validation script
    
  blocked:
    - task-74  # File size limit (waiting for tree-sitter-node)

# TASK GROUPS
groups:
  language_support:
    description: "Adding new language support"
    tasks: [task-5, task-6, task-7, task-8, task-9, task-10, task-11, task-12, task-13]
    
  performance:
    tasks: [task-25, task-60, task-74]
    
  type_system:
    tasks: [task-68, task-69, task-65, task-66, task-70, task-81]
    
  mcp_server:
    tasks: [task-49, task-50, task-52, task-54, task-57, task-58]